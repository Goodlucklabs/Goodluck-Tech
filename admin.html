<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - GoodluckTech</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal { backdrop-filter: blur(4px); }
        
        /* Dark theme styles */
        .dark {
            color-scheme: dark;
        }
        
        .dark body {
            background-color: #111827;
            color: #f9fafb;
        }
        
        .dark .bg-white {
            background-color: #1f2937;
        }
        
        .dark .bg-gray-100 {
            background-color: #111827;
        }
        
        .dark .bg-gray-50 {
            background-color: #374151;
        }
        
        .dark .text-gray-900 {
            color: #f9fafb;
        }
        
        .dark .text-gray-800 {
            color: #e5e7eb;
        }
        
        .dark .text-gray-700 {
            color: #d1d5db;
        }
        
        .dark .text-gray-600 {
            color: #9ca3af;
        }
        
        .dark .text-gray-500 {
            color: #6b7280;
        }
        
        .dark .border-gray-300 {
            border-color: #4b5563;
        }
        
        .dark .border {
            border-color: #374151;
        }
        
        .dark .shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.2);
        }
        
        .dark .shadow-sm {
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2);
        }
        
        .dark .shadow-2xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
        
        .dark input, .dark textarea, .dark select {
            background-color: #374151;
            border-color: #4b5563;
            color: #f9fafb;
        }
        
        .dark input:focus, .dark textarea:focus, .dark select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .dark .hover\\:bg-gray-50:hover {
            background-color: #4b5563;
        }
        
        .dark .hover\\:bg-gray-600:hover {
            background-color: #4b5563;
        }
        
        .dark .hover\\:text-gray-700:hover {
            color: #d1d5db;
        }
        
        /* Theme toggle button */
        .theme-toggle {
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-900 to-purple-900 relative">
        <!-- Theme toggle for login screen -->
        <button onclick="toggleTheme()" class="absolute top-4 right-4 theme-toggle p-3 rounded-full bg-white bg-opacity-20 hover:bg-opacity-30 transition duration-200" title="Toggle Dark Mode">
            <i id="loginThemeIcon" class="fas fa-moon text-white text-lg"></i>
        </button>
        
        <div class="bg-white p-8 rounded-lg shadow-2xl w-96">
            <div class="text-center mb-8">
                <i class="fas fa-shield-alt text-4xl text-blue-600 mb-4"></i>
                <h1 class="text-2xl font-bold text-gray-800">Admin Access</h1>
                <p class="text-gray-600">Secure Login Required</p>
            </div>
            
            <!-- First Security Layer -->
            <div id="firstAuth" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" id="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter admin email">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="password1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter password">
                </div>
                <button onclick="firstAuth()" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200">
                    <i class="fas fa-key mr-2"></i>Continue
                </button>
            </div>

            <!-- Second Security Layer -->
            <div id="secondAuth" class="space-y-4 hidden">
                <div class="text-center mb-4">
                    <i class="fas fa-lock text-2xl text-green-600 mb-2"></i>
                    <p class="text-sm text-gray-600">Second Security Layer</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Admin ID</label>
                    <input type="text" id="adminId" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Enter admin ID">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Verification Password</label>
                    <input type="password" id="password2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Enter verification password">
                </div>
                <button onclick="secondAuth()" class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-200">
                    <i class="fas fa-unlock mr-2"></i>Access Admin Panel
                </button>
                <button onclick="goBack()" class="w-full bg-gray-500 text-white py-2 px-4 rounded-md hover:bg-gray-600 transition duration-200">
                    <i class="fas fa-arrow-left mr-2"></i>Back
                </button>
            </div>

            <div id="errorMessage" class="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded hidden">
                <i class="fas fa-exclamation-triangle mr-2"></i>
                <span id="errorText"></span>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="hidden">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <i class="fas fa-cogs text-2xl text-blue-600 mr-3"></i>
                        <h1 class="text-2xl font-bold text-gray-900">GoodluckTech Admin</h1>
                    </div>
                    <div class="flex items-center space-x-3">
                        <button onclick="toggleTheme()" class="theme-toggle p-2 rounded-md hover:bg-gray-100 transition duration-200" title="Toggle Dark Mode">
                            <i id="themeIcon" class="fas fa-moon text-gray-600"></i>
                        </button>
                        <button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition duration-200">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <div class="bg-white border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <nav class="flex space-x-8">
                    <button onclick="showTab('jobs')" id="jobsTab" class="py-4 px-1 border-b-2 border-blue-500 font-medium text-sm text-blue-600">
                        <i class="fas fa-briefcase mr-2"></i>Jobs Management
                    </button>
                    <button onclick="showTab('news')" id="newsTab" class="py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700">
                        <i class="fas fa-newspaper mr-2"></i>News & Announcements
                    </button>
                    <button onclick="showTab('applications')" id="applicationsTab" class="py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700">
                        <i class="fas fa-users mr-2"></i>Job Applications
                    </button>
                    <button onclick="showTab('messages')" id="messagesTab" class="py-4 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700">
                        <i class="fas fa-envelope mr-2"></i>Contact Messages
                    </button>
                </nav>
            </div>
        </div>

        <!-- Content Area -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Jobs Management Tab -->
            <div id="jobsContent" class="tab-content">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-semibold text-gray-900">Jobs Management</h2>
                    <button onclick="openJobModal()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200">
                        <i class="fas fa-plus mr-2"></i>Add New Job
                    </button>
                </div>
                <div id="jobsList" class="space-y-4">
                    <!-- Jobs will be loaded here -->
                </div>
            </div>

            <!-- News Management Tab -->
            <div id="newsContent" class="tab-content hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-semibold text-gray-900">News & Announcements</h2>
                    <button onclick="openNewsModal()" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition duration-200">
                        <i class="fas fa-plus mr-2"></i>Add News
                    </button>
                </div>
                <div id="newsList" class="space-y-4">
                    <!-- News will be loaded here -->
                </div>
            </div>

            <!-- Applications Tab -->
            <div id="applicationsContent" class="tab-content hidden">
                <h2 class="text-xl font-semibold text-gray-900 mb-6">Job Applications</h2>
                <div id="applicationsList" class="space-y-4">
                    <!-- Applications will be loaded here -->
                </div>
            </div>

            <!-- Contact Messages Tab -->
            <div id="messagesContent" class="tab-content hidden">
                <h2 class="text-xl font-semibold text-gray-900 mb-6">Contact Messages</h2>
                <div id="messagesList" class="space-y-4">
                    <!-- Messages will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Job Modal -->
    <div id="jobModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-2xl max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold" id="jobModalTitle">Add New Job</h3>
                <button onclick="closeJobModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="jobForm" class="space-y-4">
                <input type="hidden" id="jobId">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Job Title</label>
                        <input type="text" id="jobTitle" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Department</label>
                        <input type="text" id="jobDepartment" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Job Type</label>
                        <select id="jobType" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Select Type</option>
                            <option value="full-time">Full Time</option>
                            <option value="part-time">Part Time</option>
                            <option value="contract">Contract</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Location</label>
                        <input type="text" id="jobLocation" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Min Salary</label>
                        <input type="number" id="jobSalaryMin" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Max Salary</label>
                        <input type="number" id="jobSalaryMax" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                    <textarea id="jobDescription" required rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Requirements</label>
                    <textarea id="jobRequirements" required rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Benefits</label>
                    <textarea id="jobBenefits" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Skills (comma separated)</label>
                    <input type="text" id="jobSkills" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="JavaScript, React, Node.js">
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="jobIsActive" class="mr-2">
                    <label for="jobIsActive" class="text-sm font-medium text-gray-700">Active Job Posting</label>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeJobModal()" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Save Job</button>
                </div>
            </form>
        </div>
    </div>

    <!-- News Modal -->
    <div id="newsModal" class="fixed inset-0 bg-black bg-opacity-50 modal hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-2xl max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold" id="newsModalTitle">Add News</h3>
                <button onclick="closeNewsModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="newsForm" class="space-y-4">
                <input type="hidden" id="newsId">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                    <input type="text" id="newsTitle" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                    <select id="newsCategory" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                        <option value="">Select Category</option>
                        <option value="product-update">Product Update</option>
                        <option value="partnership">Partnership</option>
                        <option value="team-news">Team News</option>
                        <option value="company-news">Company News</option>
                        <option value="announcement">General Announcement</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Content</label>
                    <textarea id="newsContent" required rows="6" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"></textarea>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="newsIsPublished" class="mr-2">
                    <label for="newsIsPublished" class="text-sm font-medium text-gray-700">Publish Immediately</label>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeNewsModal()" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">Save News</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Configuration
        const API_BASE = window.location.origin; // Will use the same domain
        
        // Mock data for demonstration (since API is not working yet)
        let mockJobs = [
            {
                id: "1",
                title: "Senior Frontend Developer",
                department: "Engineering",
                type: "full-time",
                location: "Remote",
                salaryMin: 80000,
                salaryMax: 120000,
                description: "We are looking for a Senior Frontend Developer to join our team. You will be responsible for building user-facing features using React and TypeScript.",
                requirements: "5+ years of experience with React, TypeScript, and modern frontend tools. Experience with state management libraries and testing frameworks.",
                benefits: "Health insurance, 401k matching, flexible work hours, remote work options",
                skills: ["React", "TypeScript", "JavaScript", "CSS", "HTML"],
                isActive: true,
                createdAt: new Date("2024-01-15"),
                updatedAt: new Date("2024-01-15"),
            },
            {
                id: "2",
                title: "Backend Engineer",
                department: "Engineering",
                type: "full-time",
                location: "New York, NY",
                salaryMin: 90000,
                salaryMax: 140000,
                description: "Join our backend team to build scalable APIs and services. You'll work with Node.js, PostgreSQL, and cloud technologies.",
                requirements: "3+ years of backend development experience. Strong knowledge of Node.js, databases, and API design.",
                benefits: "Competitive salary, stock options, health benefits, learning budget",
                skills: ["Node.js", "PostgreSQL", "API Design", "AWS", "Docker"],
                isActive: true,
                createdAt: new Date("2024-01-10"),
                updatedAt: new Date("2024-01-10"),
            }
        ];

        let mockNews = [
            {
                id: "1",
                title: "Company Expansion Announcement",
                content: "We're excited to announce that GoodluckTech is expanding to new markets! We'll be opening offices in three new cities this year.",
                category: "company-news",
                isPublished: true,
                publishedAt: new Date("2024-01-20"),
                createdAt: new Date("2024-01-20"),
                updatedAt: new Date("2024-01-20"),
            },
            {
                id: "2",
                title: "New Product Launch",
                content: "Our latest product feature is now live! This update includes improved performance and new collaboration tools.",
                category: "product-update",
                isPublished: true,
                publishedAt: new Date("2024-01-18"),
                createdAt: new Date("2024-01-18"),
                updatedAt: new Date("2024-01-18"),
            }
        ];

        let mockApplications = []; // Start with empty applications

        let mockMessages = [
            {
                id: "msg1",
                name: "Alice Johnson",
                email: "alice.johnson@example.com",
                subject: "Partnership Inquiry",
                message: "Hi, I'm interested in exploring potential partnership opportunities with GoodluckTech. Could we schedule a call to discuss?",
                status: "unread",
                createdAt: new Date("2024-01-25"),
                updatedAt: new Date("2024-01-25"),
            },
            {
                id: "msg2",
                name: "Bob Wilson",
                email: "bob.wilson@techcorp.com",
                subject: "Technical Question",
                message: "I have some questions about your blockchain solutions. Can someone from your technical team reach out to me?",
                status: "read",
                createdAt: new Date("2024-01-24"),
                updatedAt: new Date("2024-01-24"),
            }
        ];

        // Use real API calls now that they work
        const USE_MOCK_DATA = false;
        
        // Authentication credentials
        const ADMIN_CREDENTIALS = {
            email: 'goodlucklabs@gmail.com',
            password1: 'Sipun1855@',
            adminId: '1855562323',
            password2: 'Sipun1855@'
        };

        // Authentication functions
        function firstAuth() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password1').value;
            
            if (email === ADMIN_CREDENTIALS.email && password === ADMIN_CREDENTIALS.password1) {
                document.getElementById('firstAuth').classList.add('hidden');
                document.getElementById('secondAuth').classList.remove('hidden');
                hideError();
            } else {
                showError('Invalid email or password');
            }
        }

        function secondAuth() {
            const adminId = document.getElementById('adminId').value;
            const password = document.getElementById('password2').value;
            
            if (adminId === ADMIN_CREDENTIALS.adminId && password === ADMIN_CREDENTIALS.password2) {
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('adminDashboard').classList.remove('hidden');
                document.getElementById('adminDashboard').classList.add('fade-in');
                loadDashboardData();
            } else {
                showError('Invalid admin ID or verification password');
            }
        }

        function goBack() {
            document.getElementById('secondAuth').classList.add('hidden');
            document.getElementById('firstAuth').classList.remove('hidden');
            hideError();
        }

        function logout() {
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('firstAuth').classList.remove('hidden');
            document.getElementById('secondAuth').classList.add('hidden');
            // Clear form data
            document.getElementById('email').value = '';
            document.getElementById('password1').value = '';
            document.getElementById('adminId').value = '';
            document.getElementById('password2').value = '';
            hideError();
        }

        function showError(message) {
            document.getElementById('errorText').textContent = message;
            document.getElementById('errorMessage').classList.remove('hidden');
        }

        function hideError() {
            document.getElementById('errorMessage').classList.add('hidden');
        }

        // Tab management
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            
            // Remove active class from all tabs
            document.querySelectorAll('nav button').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Show selected tab content
            document.getElementById(tabName + 'Content').classList.remove('hidden');
            
            // Add active class to selected tab
            const activeTab = document.getElementById(tabName + 'Tab');
            activeTab.classList.remove('border-transparent', 'text-gray-500');
            activeTab.classList.add('border-blue-500', 'text-blue-600');
            
            // Load data for the selected tab
            if (tabName === 'jobs') loadJobs();
            else if (tabName === 'news') loadNews();
            else if (tabName === 'applications') loadApplications();
            else if (tabName === 'messages') loadMessages();
        }

        // API functions
        async function apiCall(endpoint, options = {}) {
            // Use mock data for now since API is not working
            if (USE_MOCK_DATA) {
                return mockApiCall(endpoint, options);
            }
            
            try {
                const response = await fetch(API_BASE + endpoint, {
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    },
                    ...options
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error('API call failed:', error);
                alert('API call failed: ' + error.message);
                return null;
            }
        }

        // Mock API implementation
        function mockApiCall(endpoint, options = {}) {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const method = options.method || 'GET';
                    const body = options.body ? JSON.parse(options.body) : null;
                    
                    console.log(`Mock API: ${method} ${endpoint}`, body);
                    
                    // Handle different endpoints
                    if (endpoint === '/api/jobs') {
                        if (method === 'GET') {
                            resolve(mockJobs);
                        } else if (method === 'POST') {
                            const newJob = {
                                id: Date.now().toString(),
                                ...body,
                                createdAt: new Date(),
                                updatedAt: new Date()
                            };
                            mockJobs.push(newJob);
                            resolve(newJob);
                        }
                    } else if (endpoint.startsWith('/api/jobs/')) {
                        const jobId = endpoint.split('/')[3];
                        const jobIndex = mockJobs.findIndex(j => j.id === jobId);
                        
                        if (method === 'GET') {
                            resolve(mockJobs.find(j => j.id === jobId));
                        } else if (method === 'PUT' && jobIndex !== -1) {
                            mockJobs[jobIndex] = { ...mockJobs[jobIndex], ...body, updatedAt: new Date() };
                            resolve(mockJobs[jobIndex]);
                        } else if (method === 'DELETE' && jobIndex !== -1) {
                            mockJobs[jobIndex].isActive = false;
                            resolve({ success: true });
                        }
                    } else if (endpoint === '/api/admin/announcements') {
                        resolve(mockNews);
                    } else if (endpoint === '/api/announcements') {
                        if (method === 'POST') {
                            const newNews = {
                                id: Date.now().toString(),
                                ...body,
                                createdAt: new Date(),
                                updatedAt: new Date()
                            };
                            mockNews.push(newNews);
                            resolve(newNews);
                        }
                    } else if (endpoint.startsWith('/api/announcements/')) {
                        const newsId = endpoint.split('/')[3];
                        const newsIndex = mockNews.findIndex(n => n.id === newsId);
                        
                        if (method === 'PUT' && newsIndex !== -1) {
                            mockNews[newsIndex] = { ...mockNews[newsIndex], ...body, updatedAt: new Date() };
                            resolve(mockNews[newsIndex]);
                        } else if (method === 'DELETE' && newsIndex !== -1) {
                            mockNews.splice(newsIndex, 1);
                            resolve({ success: true });
                        }
                    } else if (endpoint === '/api/applications') {
                        resolve(mockApplications);
                    } else if (endpoint.startsWith('/api/applications/') && endpoint.endsWith('/status')) {
                        const appId = endpoint.split('/')[3];
                        const appIndex = mockApplications.findIndex(a => a.id === appId);
                        
                        if (method === 'PUT' && appIndex !== -1) {
                            mockApplications[appIndex].status = body.status;
                            mockApplications[appIndex].updatedAt = new Date();
                            resolve(mockApplications[appIndex]);
                        }
                    } else if (endpoint === '/api/admin/contact-messages') {
                        resolve(mockMessages);
                    } else if (endpoint.startsWith('/api/admin/contact-messages/') && endpoint.endsWith('/status')) {
                        const msgId = endpoint.split('/')[4];
                        const msgIndex = mockMessages.findIndex(m => m.id === msgId);
                        
                        if (method === 'PUT' && msgIndex !== -1) {
                            mockMessages[msgIndex].status = body.status;
                            mockMessages[msgIndex].updatedAt = new Date();
                            resolve(mockMessages[msgIndex]);
                        }
                    } else if (endpoint.startsWith('/api/admin/contact-messages/')) {
                        const msgId = endpoint.split('/')[4];
                        const msgIndex = mockMessages.findIndex(m => m.id === msgId);
                        
                        if (method === 'DELETE' && msgIndex !== -1) {
                            mockMessages.splice(msgIndex, 1);
                            resolve({ success: true });
                        }
                    }
                    
                    resolve(null);
                }, 100); // Simulate network delay
            });
        }

        // Load dashboard data
        async function loadDashboardData() {
            loadJobs();
        }

        // Jobs management
        async function loadJobs() {
            const jobs = await apiCall('/api/jobs');
            if (jobs) {
                displayJobs(jobs);
            }
        }

        function displayJobs(jobs) {
            const jobsList = document.getElementById('jobsList');
            jobsList.innerHTML = '';
            
            if (jobs.length === 0) {
                jobsList.innerHTML = '<p class="text-gray-500 text-center py-8">No jobs found</p>';
                return;
            }
            
            jobs.forEach(job => {
                const jobCard = document.createElement('div');
                jobCard.className = 'bg-white p-6 rounded-lg shadow border';
                jobCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-gray-900">${job.title}</h3>
                            <p class="text-gray-600">${job.department} • ${job.type} • ${job.location}</p>
                            <p class="text-gray-500 text-sm mt-1">
                                ${job.salaryMin && job.salaryMax ? `$${job.salaryMin.toLocaleString()} - $${job.salaryMax.toLocaleString()}` : 'Salary not specified'}
                            </p>
                            <p class="text-gray-700 mt-2">${job.description.substring(0, 150)}...</p>
                            <div class="mt-2">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${job.isActive ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                    ${job.isActive ? 'Active' : 'Inactive'}
                                </span>
                            </div>
                        </div>
                        <div class="flex space-x-2 ml-4">
                            <button onclick="editJob('${job.id}')" class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteJob('${job.id}')" class="text-red-600 hover:text-red-800">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                jobsList.appendChild(jobCard);
            });
        }

        function openJobModal(jobId = null) {
            document.getElementById('jobModal').classList.remove('hidden');
            document.getElementById('jobForm').reset();
            
            if (jobId) {
                document.getElementById('jobModalTitle').textContent = 'Edit Job';
                // Load job data for editing
                loadJobForEdit(jobId);
            } else {
                document.getElementById('jobModalTitle').textContent = 'Add New Job';
                document.getElementById('jobIsActive').checked = true;
            }
        }

        function closeJobModal() {
            document.getElementById('jobModal').classList.add('hidden');
        }

        async function loadJobForEdit(jobId) {
            const job = await apiCall(`/api/jobs/${jobId}`);
            if (job) {
                document.getElementById('jobId').value = job.id;
                document.getElementById('jobTitle').value = job.title;
                document.getElementById('jobDepartment').value = job.department;
                document.getElementById('jobType').value = job.type;
                document.getElementById('jobLocation').value = job.location;
                document.getElementById('jobSalaryMin').value = job.salaryMin || '';
                document.getElementById('jobSalaryMax').value = job.salaryMax || '';
                document.getElementById('jobDescription').value = job.description;
                document.getElementById('jobRequirements').value = job.requirements;
                document.getElementById('jobBenefits').value = job.benefits || '';
                document.getElementById('jobSkills').value = job.skills.join(', ');
                document.getElementById('jobIsActive').checked = job.isActive;
            }
        }

        async function editJob(jobId) {
            openJobModal(jobId);
        }

        async function deleteJob(jobId) {
            if (confirm('Are you sure you want to delete this job?')) {
                const result = await apiCall(`/api/jobs/${jobId}`, { method: 'DELETE' });
                if (result !== null) {
                    loadJobs();
                }
            }
        }

        // Job form submission
        document.getElementById('jobForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const jobData = {
                title: document.getElementById('jobTitle').value,
                department: document.getElementById('jobDepartment').value,
                type: document.getElementById('jobType').value,
                location: document.getElementById('jobLocation').value,
                salaryMin: parseInt(document.getElementById('jobSalaryMin').value) || null,
                salaryMax: parseInt(document.getElementById('jobSalaryMax').value) || null,
                description: document.getElementById('jobDescription').value,
                requirements: document.getElementById('jobRequirements').value,
                benefits: document.getElementById('jobBenefits').value || null,
                skills: document.getElementById('jobSkills').value.split(',').map(s => s.trim()),
                isActive: document.getElementById('jobIsActive').checked
            };
            
            const jobId = document.getElementById('jobId').value;
            const endpoint = jobId ? `/api/jobs/${jobId}` : '/api/jobs';
            const method = jobId ? 'PUT' : 'POST';
            
            const result = await apiCall(endpoint, {
                method: method,
                body: JSON.stringify(jobData)
            });
            
            if (result) {
                closeJobModal();
                loadJobs();
            }
        });

        // News management
        async function loadNews() {
            const news = await apiCall('/api/admin/announcements');
            if (news) {
                displayNews(news);
            }
        }

        function displayNews(news) {
            const newsList = document.getElementById('newsList');
            newsList.innerHTML = '';
            
            if (news.length === 0) {
                newsList.innerHTML = '<p class="text-gray-500 text-center py-8">No news found</p>';
                return;
            }
            
            news.forEach(item => {
                const newsCard = document.createElement('div');
                newsCard.className = 'bg-white p-6 rounded-lg shadow border';
                newsCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-gray-900">${item.title}</h3>
                            <p class="text-gray-600 capitalize">${item.category.replace('-', ' ')}</p>
                            <p class="text-gray-700 mt-2">${item.content.substring(0, 200)}...</p>
                            <div class="mt-2 flex items-center space-x-4">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${item.isPublished ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                                    ${item.isPublished ? 'Published' : 'Draft'}
                                </span>
                                <span class="text-xs text-gray-500">
                                    ${new Date(item.createdAt).toLocaleDateString()}
                                </span>
                            </div>
                        </div>
                        <div class="flex space-x-2 ml-4">
                            <button onclick="editNews('${item.id}')" class="text-blue-600 hover:text-blue-800">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteNews('${item.id}')" class="text-red-600 hover:text-red-800">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                newsList.appendChild(newsCard);
            });
        }

        function openNewsModal(newsId = null) {
            document.getElementById('newsModal').classList.remove('hidden');
            document.getElementById('newsForm').reset();
            
            if (newsId) {
                document.getElementById('newsModalTitle').textContent = 'Edit News';
                loadNewsForEdit(newsId);
            } else {
                document.getElementById('newsModalTitle').textContent = 'Add News';
            }
        }

        function closeNewsModal() {
            document.getElementById('newsModal').classList.add('hidden');
        }

        async function loadNewsForEdit(newsId) {
            const allNews = await apiCall('/api/admin/announcements');
            if (allNews) {
                const news = allNews.find(item => item.id === newsId);
                if (news) {
                    document.getElementById('newsId').value = news.id;
                    document.getElementById('newsTitle').value = news.title;
                    document.getElementById('newsCategory').value = news.category;
                    document.getElementById('newsContent').value = news.content;
                    document.getElementById('newsIsPublished').checked = news.isPublished;
                }
            }
        }

        async function editNews(newsId) {
            openNewsModal(newsId);
        }

        async function deleteNews(newsId) {
            if (confirm('Are you sure you want to delete this news item?')) {
                const result = await apiCall(`/api/announcements/${newsId}`, { method: 'DELETE' });
                if (result !== null) {
                    loadNews();
                }
            }
        }

        // News form submission
        document.getElementById('newsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const newsData = {
                title: document.getElementById('newsTitle').value,
                category: document.getElementById('newsCategory').value,
                content: document.getElementById('newsContent').value,
                isPublished: document.getElementById('newsIsPublished').checked
            };
            
            const newsId = document.getElementById('newsId').value;
            const endpoint = newsId ? `/api/announcements/${newsId}` : '/api/announcements';
            const method = newsId ? 'PUT' : 'POST';
            
            const result = await apiCall(endpoint, {
                method: method,
                body: JSON.stringify(newsData)
            });
            
            if (result) {
                closeNewsModal();
                loadNews();
            }
        });

        // Applications management
        async function loadApplications() {
            const applications = await apiCall('/api/applications');
            if (applications) {
                displayApplications(applications);
            }
        }

        function displayApplications(applications) {
            const applicationsList = document.getElementById('applicationsList');
            applicationsList.innerHTML = '';
            
            if (applications.length === 0) {
                applicationsList.innerHTML = '<p class="text-gray-500 text-center py-8">No applications found</p>';
                return;
            }
            
            applications.forEach(app => {
                const appCard = document.createElement('div');
                appCard.className = 'bg-white p-6 rounded-lg shadow border';
                appCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-gray-900">${app.firstName} ${app.lastName}</h3>
                            <p class="text-gray-600">${app.email}</p>
                            <p class="text-gray-500 text-sm">Job ID: ${app.jobId}</p>
                            ${app.portfolioUrl ? `<p class="text-blue-600 text-sm"><a href="${app.portfolioUrl}" target="_blank">Portfolio</a></p>` : ''}
                            ${app.resumeUrl ? `<p class="text-blue-600 text-sm"><a href="${app.resumeUrl}" target="_blank">Resume</a></p>` : ''}
                            <div class="mt-2">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getStatusColor(app.status)}">
                                    ${app.status.charAt(0).toUpperCase() + app.status.slice(1)}
                                </span>
                                <span class="text-xs text-gray-500 ml-2">
                                    ${new Date(app.createdAt).toLocaleDateString()}
                                </span>
                            </div>
                            ${app.coverLetter ? `<p class="text-gray-700 mt-2 text-sm">${app.coverLetter.substring(0, 100)}...</p>` : ''}
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            <select onchange="updateApplicationStatus('${app.id}', this.value)" class="text-sm border border-gray-300 rounded px-2 py-1">
                                <option value="pending" ${app.status === 'pending' ? 'selected' : ''}>Pending</option>
                                <option value="reviewing" ${app.status === 'reviewing' ? 'selected' : ''}>Reviewing</option>
                                <option value="accepted" ${app.status === 'accepted' ? 'selected' : ''}>Accepted</option>
                                <option value="rejected" ${app.status === 'rejected' ? 'selected' : ''}>Rejected</option>
                            </select>
                        </div>
                    </div>
                `;
                applicationsList.appendChild(appCard);
            });
        }

        function getStatusColor(status) {
            switch (status) {
                case 'pending': return 'bg-yellow-100 text-yellow-800';
                case 'reviewing': return 'bg-blue-100 text-blue-800';
                case 'accepted': return 'bg-green-100 text-green-800';
                case 'rejected': return 'bg-red-100 text-red-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        async function updateApplicationStatus(appId, status) {
            const result = await apiCall(`/api/applications/${appId}/status`, {
                method: 'PUT',
                body: JSON.stringify({ status })
            });
            
            if (result) {
                // Status updated successfully
                console.log('Status updated');
            }
        }

        // Contact Messages management
        async function loadMessages() {
            const messages = await apiCall('/api/admin/contact-messages');
            if (messages) {
                displayMessages(messages);
            }
        }

        function displayMessages(messages) {
            const messagesList = document.getElementById('messagesList');
            messagesList.innerHTML = '';
            
            if (messages.length === 0) {
                messagesList.innerHTML = '<p class="text-gray-500 text-center py-8">No messages found</p>';
                return;
            }
            
            messages.forEach(msg => {
                const msgCard = document.createElement('div');
                msgCard.className = `bg-white p-6 rounded-lg shadow border ${msg.status === 'unread' ? 'border-l-4 border-l-blue-500' : ''}`;
                msgCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <h3 class="text-lg font-semibold text-gray-900">${msg.name}</h3>
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getMessageStatusColor(msg.status)}">
                                    ${msg.status.charAt(0).toUpperCase() + msg.status.slice(1)}
                                </span>
                            </div>
                            <p class="text-gray-600 mb-1">${msg.email}</p>
                            <p class="text-gray-900 font-medium mb-2">${msg.subject}</p>
                            <p class="text-gray-700 text-sm mb-3">${msg.message}</p>
                            <span class="text-xs text-gray-500">
                                ${new Date(msg.createdAt).toLocaleDateString()} ${new Date(msg.createdAt).toLocaleTimeString()}
                            </span>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            <select onchange="updateMessageStatus('${msg.id}', this.value)" class="text-sm border border-gray-300 rounded px-2 py-1">
                                <option value="unread" ${msg.status === 'unread' ? 'selected' : ''}>Unread</option>
                                <option value="read" ${msg.status === 'read' ? 'selected' : ''}>Read</option>
                                <option value="replied" ${msg.status === 'replied' ? 'selected' : ''}>Replied</option>
                            </select>
                            <button onclick="deleteMessage('${msg.id}')" class="text-red-600 hover:text-red-800 text-sm px-2 py-1 border border-red-300 rounded hover:bg-red-50">
                                <i class="fas fa-trash mr-1"></i>Delete
                            </button>
                            <a href="mailto:${msg.email}?subject=Re: ${encodeURIComponent(msg.subject)}" class="text-blue-600 hover:text-blue-800 text-sm px-2 py-1 border border-blue-300 rounded hover:bg-blue-50 text-center">
                                <i class="fas fa-reply mr-1"></i>Reply
                            </a>
                        </div>
                    </div>
                `;
                messagesList.appendChild(msgCard);
            });
        }

        function getMessageStatusColor(status) {
            switch (status) {
                case 'unread': return 'bg-blue-100 text-blue-800';
                case 'read': return 'bg-yellow-100 text-yellow-800';
                case 'replied': return 'bg-green-100 text-green-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        async function updateMessageStatus(msgId, status) {
            const result = await apiCall(`/api/admin/contact-messages/${msgId}/status`, {
                method: 'PUT',
                body: JSON.stringify({ status })
            });
            
            if (result) {
                console.log('Message status updated');
            }
        }

        async function deleteMessage(msgId) {
            if (confirm('Are you sure you want to delete this message?')) {
                const result = await apiCall(`/api/admin/contact-messages/${msgId}`, {
                    method: 'DELETE'
                });
                
                if (result) {
                    loadMessages(); // Reload messages
                }
            }
        }

        // Theme management
        function toggleTheme() {
            const html = document.documentElement;
            const themeIcon = document.getElementById('themeIcon');
            const loginThemeIcon = document.getElementById('loginThemeIcon');
            const isDark = html.classList.contains('dark');
            
            if (isDark) {
                // Switch to light theme
                html.classList.remove('dark');
                if (themeIcon) {
                    themeIcon.className = 'fas fa-moon text-gray-600';
                }
                if (loginThemeIcon) {
                    loginThemeIcon.className = 'fas fa-moon text-white text-lg';
                }
                localStorage.setItem('theme', 'light');
            } else {
                // Switch to dark theme
                html.classList.add('dark');
                if (themeIcon) {
                    themeIcon.className = 'fas fa-sun text-yellow-500';
                }
                if (loginThemeIcon) {
                    loginThemeIcon.className = 'fas fa-sun text-yellow-300 text-lg';
                }
                localStorage.setItem('theme', 'dark');
            }
        }
        
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme');
            const html = document.documentElement;
            const themeIcon = document.getElementById('themeIcon');
            const loginThemeIcon = document.getElementById('loginThemeIcon');
            
            // Always start with light theme by default
            if (savedTheme === 'dark') {
                html.classList.add('dark');
                if (themeIcon) {
                    themeIcon.className = 'fas fa-sun text-yellow-500';
                }
                if (loginThemeIcon) {
                    loginThemeIcon.className = 'fas fa-sun text-yellow-300 text-lg';
                }
            } else {
                html.classList.remove('dark');
                if (themeIcon) {
                    themeIcon.className = 'fas fa-moon text-gray-600';
                }
                if (loginThemeIcon) {
                    loginThemeIcon.className = 'fas fa-moon text-white text-lg';
                }
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize theme
            initializeTheme();
            
            // Add enter key support for login forms
            document.getElementById('password1').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') firstAuth();
            });
            
            document.getElementById('password2').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') secondAuth();
            });
        });
    </script>
</body>
</html>